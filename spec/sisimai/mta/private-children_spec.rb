require 'spec_helper'
require 'sisimai'
require 'sisimai/rfc5322'

describe 'Sisimai::MTA::' do
  PrivateMTAChildren = {
    'Activehunter' => {
      '01001' => %r/filtered/,
      '01002' => %r/userunknown/,
      '01003' => %r/filtered/,
      '01004' => %r/filtered/,
      '01005' => %r/userunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/filtered/,
      '01008' => %r/filtered/,
      '01009' => %r/userunknown/,
      '01010' => %r/filtered/,
      '01011' => %r/filtered/,
      '01012' => %r/userunknown/,
    },
    'ApacheJames' => {
      '01001' => %r/filtered/,
      '01002' => %r/filtered/,
      '01003' => %r/filtered/,
      '01004' => %r/undefined/,
      '01005' => %r/undefined/,
    },
    'Courier' => {
      '01001' => %r/filtered/,
      '01002' => %r/filtered/,
      '01003' => %r/blocked/,
      '01004' => %r/userunknown/,
      '01005' => %r/userunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
      '01008' => %r/userunknown/,
      '01009' => %r/filtered/,
      '01010' => %r/blocked/,
      '01011' => %r/hostunknown/,
      '01012' => %r/hostunknown/,
    },
    'Domino' => {
      '01001' => %r/onhold/,
      '01002' => %r/userunknown/,
      '01003' => %r/userunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/onhold/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
      '01008' => %r/userunknown/,
      '01009' => %r/userunknown/,
      '01010' => %r/userunknown/,
      '01011' => %r/userunknown/,
      '01012' => %r/userunknown/,
      '01013' => %r/userunknown/,
    },
    'Exchange2003' => {
      '01001' => %r/userunknown/,
      '01002' => %r/userunknown/,
      '01003' => %r/userunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/userunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
      '01008' => %r/userunknown/,
      '01009' => %r/userunknown/,
      '01010' => %r/userunknown/,
      '01011' => %r/userunknown/,
      '01012' => %r/userunknown/,
      '01013' => %r/userunknown/,
      '01014' => %r/userunknown/,
      '01015' => %r/userunknown/,
      '01016' => %r/userunknown/,
      '01017' => %r/filtered/,
      '01018' => %r/userunknown/,
      '01019' => %r/userunknown/,
      '01020' => %r/userunknown/,
      '01021' => %r/userunknown/,
      '01022' => %r/userunknown/,
      '01023' => %r/filtered/,
      '01024' => %r/userunknown/,
      '01025' => %r/userunknown/,
      '01026' => %r/userunknown/,
      '01027' => %r/userunknown/,
      '01028' => %r/userunknown/,
      '01029' => %r/userunknown/,
      '01030' => %r/userunknown/,
      '01031' => %r/userunknown/,
      '01032' => %r/userunknown/,
      '01033' => %r/userunknown/,
    },
    'Exchange2007' => {
      '01001' => %r/userunknown/,
      '01002' => %r/mesgtoobig/,
      '01003' => %r/undefined/,
      '01004' => %r/userunknown/,
    },
    'Exim' => {
      '01001' => %r/policyviolation/,
      '01002' => %r/expired/,
      '01003' => %r/filtered/,
      '01004' => %r/blocked/,
      '01005' => %r/userunknown/,
      '01006' => %r/filtered/,
      '01007' => %r/policyviolation/,
      '01008' => %r/userunknown/,
      '01009' => %r/hostunknown/,
      '01010' => %r/blocked/,
      '01011' => %r/userunknown/,
      '01012' => %r/userunknown/,
      '01013' => %r/userunknown/,
      '01014' => %r/expired/,
      '01015' => %r/expired/,
      '01016' => %r/userunknown/,
      '01017' => %r/expired/,
      '01018' => %r/userunknown/,
      '01019' => %r/userunknown/,
      '01020' => %r/userunknown/,
      '01022' => %r/userunknown/,
      '01023' => %r/userunknown/,
      '01024' => %r/userunknown/,
      '01025' => %r/userunknown/,
      '01026' => %r/userunknown/,
      '01027' => %r/expired/,
      '01028' => %r/mailboxfull/,
      '01029' => %r/userunknown/,
      '01031' => %r/expired/,
      '01032' => %r/userunknown/,
      '01033' => %r/userunknown/,
      '01034' => %r/userunknown/,
      '01035' => %r/rejected/,
      '01036' => %r/userunknown/,
      '01037' => %r/expired/,
      '01038' => %r/blocked/,
      '01039' => %r/mailboxfull/,
      '01040' => %r/expired/,
      '01041' => %r/expired/,
      '01042' => %r/networkerror/,
      '01043' => %r/userunknown/,
      '01044' => %r/networkerror/,
      '01045' => %r/hostunknown/,
      '01046' => %r/userunknown/,
      '01047' => %r/userunknown/,
      '01049' => %r/suspend/,
      '01050' => %r/userunknown/,
      '01051' => %r/userunknown/,
      '01052' => %r/userunknown/,
      '01053' => %r/userunknown/,
      '01054' => %r/suspend/,
      '01055' => %r/userunknown/,
      '01056' => %r/userunknown/,
      '01057' => %r/suspend/,
      '01058' => %r/userunknown/,
      '01059' => %r/onhold/,
      '01060' => %r/expired/,
      '01061' => %r/userunknown/,
      '01062' => %r/userunknown/,
      '01063' => %r/userunknown/,
      '01064' => %r/userunknown/,
      '01065' => %r/userunknown/,
      '01066' => %r/userunknown/,
      '01067' => %r/userunknown/,
      '01068' => %r/userunknown/,
      '01069' => %r/userunknown/,
      '01070' => %r/userunknown/,
      '01071' => %r/userunknown/,
      '01072' => %r/userunknown/,
      '01073' => %r/suspend/,
      '01074' => %r/userunknown/,
      '01075' => %r/userunknown/,
      '01076' => %r/userunknown/,
      '01077' => %r/suspend/,
      '01078' => %r/undefined/,
      '01079' => %r/hostunknown/,
      '01080' => %r/hostunknown/,
      '01081' => %r/hostunknown/,
      '01082' => %r/onhold/,
      '01083' => %r/onhold/,
      '01084' => %r/systemerror/,
      '01085' => %r/(?:undefined|onhold|blocked)/,
      '01086' => %r/onhold/,
      '01087' => %r/onhold/,
      '01088' => %r/(?:systemerror|onhold)/,
      '01089' => %r/mailererror/,
      '01090' => %r/onhold/,
      '01091' => %r/onhold/,
      '01092' => %r/undefined/,
      '01093' => %r/(?:undefined|onhold|systemerror)/,
      '01094' => %r/onhold/,
      '01095' => %r/onhold/,
      '01096' => %r/(?:hostunknown|onhold)/,
      '01097' => %r/(?:hostunknown|networkerror)/,
      '01098' => %r/expired/,
      '01099' => %r/expired/,
      '01100' => %r/mailererror/,
      '01101' => %r/mailererror/,
      '01102' => %r/mailererror/,
      '01103' => %r/undefined/,
      '01104' => %r/mailererror/,
      '01105' => %r/mailererror/,
      '01106' => %r/onhold/,
      '01107' => %r/spamdetected/,
      '01108' => %r/policyviolation/,
      '01109' => %r/securityerror/,
    },
    'IMailServer' => {
      '01001' => %r/hostunknown/,
      '01002' => %r/mailboxfull/,
      '01003' => %r/userunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/mailboxfull/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
      '01008' => %r/hostunknown/,
      '01009' => %r/expired/,
      '01010' => %r/expired/,
      '01011' => %r/userunknown/,
      '01012' => %r/mailboxfull/,
      '01013' => %r/userunknown/,
      '01014' => %r/hostunknown/,
      '01015' => %r/userunknown/,
      '01016' => %r/expired/,
      '01017' => %r/expired/,
      '01018' => %r/mailboxfull/,
      '01019' => %r/mailboxfull/,
      '01020' => %r/undefined/,
      '01021' => %r/mailboxfull/,
      '01022' => %r/userunknown/,
      '01023' => %r/mailboxfull/,
      '01024' => %r/undefined/,
      '01025' => %r/userunknown/,
      '01026' => %r/userunknown/,
      '01027' => %r/userunknown/,
      '01028' => %r/userunknown/,
      '01029' => %r/userunknown/,
      '01030' => %r/hostunknown/,
      '01031' => %r/hostunknown/,
      '01032' => %r/undefined/,
      '01033' => %r/userunknown/,
      '01034' => %r/userunknown/,
      '01035' => %r/spamdetected/,
      '01036' => %r/spamdetected/,
      '01037' => %r/spamdetected/,
    },
    'InterScanMSS' => {
      '01001' => %r/userunknown/,
      '01002' => %r/userunknown/,
      '01003' => %r/userunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/userunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
    },
    'MailFoundry' => {
      '01001' => %r/filtered/,
      '01002' => %r/mailboxfull/,
      '01003' => %r/userunknown/,
      '01004' => %r/filtered/,
      '01005' => %r/mailboxfull/,
      '01007' => %r/filtered/,
    },
    'MailMarshalSMTP' => {
      '01001' => %r/filtered/,
    },
    'McAfee' => {
      '01001' => %r/userunknown/,
      '01002' => %r/userunknown/,
      '01003' => %r/userunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/userunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
    },
    'MessagingServer' => {
      '01001' => %r/hostunknown/,
      '01002' => %r/mailboxfull/,
      '01003' => %r/filtered/,
      '01004' => %r/mailboxfull/,
      '01005' => %r/hostunknown/,
      '01006' => %r/filtered/,
      '01007' => %r/mailboxfull/,
      '01008' => %r/filtered/,
      '01009' => %r/mailboxfull/,
      '01010' => %r/mailboxfull/,
      '01011' => %r/expired/,
      '01012' => %r/filtered/,
      '01013' => %r/mailboxfull/,
    },
    'MFILTER' => {
      '01001' => %r/filtered/,
      '01002' => %r/userunknown/,
      '01003' => %r/filtered/,
      '01004' => %r/filtered/,
      '01005' => %r/userunknown/,
      '01006' => %r/filtered/,
      '01007' => %r/filtered/,
    },
    'MXLogic' => {
      '01001' => %r/userunknown/,
      '01002' => %r/userunknown/,
      '01003' => %r/userunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/userunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
      '01008' => %r/userunknown/,
      '01009' => %r/userunknown/,
      '01010' => %r/filtered/,
      '01011' => %r/filtered/,
    },
    'Notes' => {
      '01001' => %r/userunknown/,
      '01002' => %r/onhold/,
      '01003' => %r/onhold/,
      '01004' => %r/userunknown/,
      '01005' => %r/onhold/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
      '01008' => %r/userunknown/,
    },
    'OpenSMTPD' => {
      '01001' => %r/userunknown/,
      '01002' => %r/filtered/,
      '01003' => %r/mailboxfull/,
      '01004' => %r/filtered/,
      '01005' => %r/filtered/,
      '01006' => %r/expired/,
      '01007' => %r/userunknown/,
      '01008' => %r/(?:mailboxfull|userunknown)/,
      '01009' => %r/hostunknown/,
      '01010' => %r/networkerror/,
      '01011' => %r/userunknown/,
      '01012' => %r/(?:mailboxfull|userunknown)/,
      '01013' => %r/hostunknown/,
      '01014' => %r/expired/,
      '01015' => %r/networkerror/,
    },
    'Postfix' => {
      '01001' => %r/filtered/,
      '01002' => %r/userunknown/,
      '01003' => %r/userunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/filtered/,
      '01006' => %r/userunknown/,
      '01007' => %r/filtered/,
      '01008' => %r/filtered/,
      '01009' => %r/userunknown/,
      '01010' => %r/hostunknown/,
      '01011' => %r/systemerror/,
      '01012' => %r/userunknown/,
      '01013' => %r/userunknown/,
      '01014' => %r/userunknown/,
      '01015' => %r/userunknown/,
      '01016' => %r/toomanyconn/,
      '01017' => %r/expired/,
      '01018' => %r/systemerror/,
      '01019' => %r/userunknown/,
      '01020' => %r/userunknown/,
      '01021' => %r/expired/,
      '01022' => %r/userunknown/,
      '01023' => %r/blocked/,
      '01024' => %r/userunknown/,
      '01025' => %r/userunknown/,
      '01026' => %r/expired/,
      '01027' => %r/systemerror/,
      '01028' => %r/suspend/,
      '01029' => %r/userunknown/,
      '01030' => %r/userunknown/,
      '01031' => %r/userunknown/,
      '01032' => %r/userunknown/,
      '01033' => %r/userunknown/,
      '01034' => %r/filtered/,
      '01035' => %r/mailboxfull/,
      '01036' => %r/hostunknown/,
      '01037' => %r/filtered/,
      '01038' => %r/blocked/,
      '01039' => %r/userunknown/,
      '01040' => %r/userunknown/,
      '01041' => %r/userunknown/,
      '01042' => %r/networkerror/,
      '01043' => %r/hasmoved/,
      '01044' => %r/mesgtoobig/,
      '01045' => %r/mesgtoobig/,
      '01046' => %r/mesgtoobig/,
      '01047' => %r/mesgtoobig/,
      '01048' => %r/userunknown/,
      '01049' => %r/hostunknown/,
      '01050' => %r/userunknown/,
      '01051' => %r/norelaying/,
      '01052' => %r/spamdetected/,
      '01053' => %r/systemerror/,
      '01054' => %r/userunknown/,
      '01055' => %r/filtered/,
      '01056' => %r/mailererror/,
      '01057' => %r/userunknown/,
      '01058' => %r/filtered/,
      '01059' => %r/userunknown/,
      '01060' => %r/userunknown/,
      '01061' => %r/hostunknown/,
      '01062' => %r/filtered/,
      '01063' => %r/mailererror/,
      '01064' => %r/hostunknown/,
      '01065' => %r/networkerror/,
      '01066' => %r/norelaying/,
      '01067' => %r/userunknown/,
      '01068' => %r/norelaying/,
      '01069' => %r/userunknown/,
      '01070' => %r/networkerror/,
      '01071' => %r/mailboxfull/,
      '01072' => %r/onhold/,
      '01073' => %r/mailboxfull/,
      '01074' => %r/mailboxfull/,
      '01075' => %r/mailboxfull/,
      '01076' => %r/filtered/,
      '01077' => %r/norelaying/,
      '01078' => %r/norelaying/,
      '01079' => %r/spamdetected/,
      '01080' => %r/spamdetected/,
      '01081' => %r/spamdetected/,
      '01082' => %r/spamdetected/,
      '01083' => %r/spamdetected/,
      '01084' => %r/spamdetected/,
      '01085' => %r/spamdetected/,
      '01086' => %r/spamdetected/,
      '01087' => %r/spamdetected/,
      '01088' => %r/spamdetected/,
      '01089' => %r/spamdetected/,
      '01090' => %r/spamdetected/,
      '01091' => %r/spamdetected/,
      '01092' => %r/spamdetected/,
      '01093' => %r/spamdetected/,
      '01094' => %r/spamdetected/,
      '01095' => %r/spamdetected/,
      '01096' => %r/spamdetected/,
      '01097' => %r/spamdetected/,
      '01098' => %r/spamdetected/,
      '01099' => %r/spamdetected/,
      '01100' => %r/spamdetected/,
      '01101' => %r/policyviolation/,
      '01102' => %r/spamdetected/,
      '01103' => %r/spamdetected/,
      '01104' => %r/spamdetected/,
      '01105' => %r/spamdetected/,
      '01106' => %r/spamdetected/,
      '01107' => %r/spamdetected/,
      '01108' => %r/spamdetected/,
      '01109' => %r/spamdetected/,
      '01110' => %r/spamdetected/,
      '01111' => %r/spamdetected/,
      '01112' => %r/spamdetected/,
      '01113' => %r/spamdetected/,
      '01114' => %r/spamdetected/,
      '01115' => %r/blocked/,
      '01116' => %r/spamdetected/,
      '01117' => %r/spamdetected/,
      '01118' => %r/spamdetected/,
      '01119' => %r/spamdetected/,
      '01120' => %r/spamdetected/,
      '01121' => %r/spamdetected/,
      '01122' => %r/hostunknown/,
      '01123' => %r/userunknown/,
      '01124' => %r/userunknown/,
      '01125' => %r/exceedlimit/,
      '01126' => %r/systemerror/,
      '01127' => %r/userunknown/,
      '01128' => %r/userunknown/,
      '01129' => %r/filtered/,
      '01130' => %r/mailboxfull/,
      '01131' => %r/exceedlimit/,
      '01132' => %r/userunknown/,
      '01133' => %r/userunknown/,
      '01134' => %r/userunknown/,
      '01135' => %r/suspend/,
      '01136' => %r/userunknown/,
      '01137' => %r/userunknown/,
      '01138' => %r/userunknown/,
      '01139' => %r/userunknown/,
      '01140' => %r/userunknown/,
      '01141' => %r/filtered/,
      '01142' => %r/blocked/,
      '01143' => %r/userunknown/,
      '01144' => %r/suspend/,
      '01145' => %r/filtered/,
      '01146' => %r/userunknown/,
      '01147' => %r/userunknown/,
      '01148' => %r/userunknown/,
      '01149' => %r/mailboxfull/,
      '01150' => %r/filtered/,
      '01151' => %r/spamdetected/,
      '01152' => %r/blocked/,
      '01153' => %r/spamdetected/,
      '01154' => %r/spamdetected/,
      '01155' => %r/userunknown/,
      '01156' => %r/userunknown/,
    },
    'Qmail' => {
      '01001' => %r/filtered/,
      '01002' => %r/undefined/,
      '01003' => %r/hostunknown/,
      '01004' => %r/userunknown/,
      '01005' => %r/hostunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/hostunknown/,
      '01008' => %r/userunknown/,
      '01009' => %r/userunknown/,
      '01010' => %r/hostunknown/,
      '01011' => %r/hostunknown/,
      '01012' => %r/userunknown/,
      '01013' => %r/userunknown/,
      '01014' => %r/rejected/,
      '01015' => %r/rejected/,
      '01016' => %r/hostunknown/,
      '01017' => %r/userunknown/,
      '01018' => %r/userunknown/,
      '01019' => %r/mailboxfull/,
      '01020' => %r/filtered/,
      '01021' => %r/userunknown/,
      '01022' => %r/userunknown/,
      '01023' => %r/userunknown/,
      '01024' => %r/userunknown/,
      '01025' => %r/(?:userunknown|filtered)/,
      '01026' => %r/mesgtoobig/,
      '01027' => %r/mailboxfull/,
      '01028' => %r/userunknown/,
      '01029' => %r/filtered/,
      '01030' => %r/userunknown/,
      '01031' => %r/userunknown/,
      '01032' => %r/networkerror/,
      '01033' => %r/mailboxfull/,
      '01034' => %r/mailboxfull/,
      '01035' => %r/mailboxfull/,
      '01036' => %r/userunknown/,
      '01037' => %r/hostunknown/,
      '01038' => %r/filtered/,
      '01039' => %r/mailboxfull/,
      '01040' => %r/mailboxfull/,
      '01041' => %r/userunknown/,
      '01042' => %r/(?:userunknown|filtered)/,
      '01043' => %r/rejected/,
      '01044' => %r/blocked/,
      '01045' => %r/systemerror/,
      '01046' => %r/mailboxfull/,
      '01047' => %r/userunknown/,
      '01048' => %r/mailboxfull/,
      '01049' => %r/mailboxfull/,
      '01050' => %r/userunknown/,
      '01051' => %r/undefined/,
      '01052' => %r/suspend/,
      '01053' => %r/filtered/,
      '01054' => %r/userunknown/,
      '01055' => %r/mailboxfull/,
      '01056' => %r/userunknown/,
      '01057' => %r/userunknown/,
      '01058' => %r/userunknown/,
      '01059' => %r/filtered/,
      '01060' => %r/suspend/,
      '01061' => %r/filtered/,
      '01062' => %r/filtered/,
      '01063' => %r/userunknown/,
      '01064' => %r/userunknown/,
      '01065' => %r/mailboxfull/,
      '01066' => %r/userunknown/,
    },
    'Sendmail' => {
      '01001' => %r/suspend/,
      '01002' => %r/blocked/,
      '01003' => %r/expired/,
      '01004' => %r/(?:userunknown|delivered)/,
      '01005' => %r/expired/,
      '01006' => %r/expired/,
      '01007' => %r/expired/,
      '01008' => %r/filtered/,
      '01009' => %r/expired/,
      '01010' => %r/blocked/,
      '01011' => %r/blocked/,
      '01012' => %r/systemerror/,
      '01013' => %r/userunknown/,
      '01014' => %r/expired/,
      '01015' => %r/hostunknown/,
      '01016' => %r/expired/,
      '01017' => %r/expired/,
      '01018' => %r/hostunknown/,
      '01019' => %r/blocked/,
      '01020' => %r/expired/,
      '01021' => %r/expired/,
      '01022' => %r/expired/,
      '01023' => %r/expired/,
      '01024' => %r/filtered/,
      '01025' => %r/mesgtoobig/,
      '01026' => %r/blocked/,
      '01027' => %r/rejected/,
      '01028' => %r/norelaying/,
      '01029' => %r/spamdetected/,
      '01030' => %r/suspend/,
      '01031' => %r/suspend/,
      '01032' => %r/mailererror/,
      '01033' => %r/mailererror/,
      '01034' => %r/mailererror/,
      '01035' => %r/userunknown/,
      '01036' => %r/filtered/,
      '01037' => %r/filtered/,
      '01038' => %r/userunknown/,
      '01039' => %r/(?:filtered|userunknown)/,
      '01040' => %r/userunknown/,
      '01041' => %r/filtered/,
      '01042' => %r/userunknown/,
      '01043' => %r/userunknown/,
      '01044' => %r/userunknown/,
      '01045' => %r/userunknown/,
      '01046' => %r/userunknown/,
      '01047' => %r/blocked/,
      '01048' => %r/userunknown/,
      '01049' => %r/userunknown/,
      '01050' => %r/userunknown/,
      '01051' => %r/userunknown/,
      '01052' => %r/userunknown/,
      '01053' => %r/userunknown/,
      '01054' => %r/userunknown/,
      '01055' => %r/userunknown/,
      '01056' => %r/userunknown/,
      '01057' => %r/userunknown/,
      '01058' => %r/norelaying/,
      '01059' => %r/userunknown/,
      '01060' => %r/userunknown/,
      '01061' => %r/blocked/,
      '01062' => %r/userunknown/,
      '01063' => %r/userunknown/,
      '01064' => %r/userunknown/,
      '01065' => %r/userunknown/,
      '01066' => %r/userunknown/,
      '01067' => %r/userunknown/,
      '01068' => %r/userunknown/,
      '01069' => %r/userunknown/,
      '01070' => %r/userunknown/,
      '01071' => %r/userunknown/,
      '01072' => %r/userunknown/,
      '01073' => %r/userunknown/,
      '01074' => %r/userunknown/,
      '01075' => %r/userunknown/,
      '01076' => %r/userunknown/,
      '01077' => %r/userunknown/,
      '01078' => %r/userunknown/,
      '01079' => %r/userunknown/,
      '01080' => %r/userunknown/,
      '01081' => %r/userunknown/,
      '01082' => %r/userunknown/,
      '01083' => %r/userunknown/,
      '01084' => %r/filtered/,
      '01085' => %r/filtered/,
      '01086' => %r/hostunknown/,
      '01087' => %r/hostunknown/,
      '01088' => %r/hostunknown/,
      '01089' => %r/norelaying/,
      '01090' => %r/filtered/,
      '01091' => %r/filtered/,
      '01092' => %r/filtered/,
      '01093' => %r/suspend/,
      '01094' => %r/mailboxfull/,
      '01095' => %r/mailboxfull/,
      '01096' => %r/mailboxfull/,
      '01097' => %r/mailboxfull/,
      '01098' => %r/exceedlimit/,
      '01099' => %r/exceedlimit/,
      '01100' => %r/exceedlimit/,
      '01101' => %r/systemerror/,
      '01102' => %r/filtered/,
      '01103' => %r/filtered/,
      '01104' => %r/mesgtoobig/,
      '01105' => %r/mesgtoobig/,
      '01106' => %r/mesgtoobig/,
      '01107' => %r/systemerror/,
      '01108' => %r/systemerror/,
      '01109' => %r/securityerror/,
      '01110' => %r/securityerror/,
      '01111' => %r/networkerror/,
      '01112' => %r/mailererror/,
      '01113' => %r/contenterror/,
      '01114' => %r/securityerror/,
      '01115' => %r/policyviolation/,
      '01116' => %r/spamdetected/,
      '01117' => %r/spamdetected/,
      '01118' => %r/userunknown/,
      '01119' => %r/filtered/,
      '01120' => %r/filtered/,
      '01121' => %r/filtered/,
      '01122' => %r/userunknown/,
      '01124' => %r/expired/,
      '01125' => %r/mesgtoobig/,
      '01127' => %r/userunknown/,
      '01128' => %r/(?:rejected|filtered|userunknown|hostunknown|blocked)/,
      '01129' => %r/hasmoved/,
      '01130' => %r/userunknown/,
      '01131' => %r/filtered/,
      '01132' => %r/filtered/,
      '01133' => %r/filtered/,
      '01134' => %r/mesgtoobig/,
      '01135' => %r/userunknown/,
      '01136' => %r/hostunknown/,
      '01137' => %r/(?:userunknown|mailboxfull)/,
      '01138' => %r/filtered/,
      '01139' => %r/filtered/,
      '01140' => %r/filtered/,
      '01141' => %r/userunknown/,
      '01142' => %r/securityerror/,
      '01143' => %r/userunknown/,
      '01144' => %r/userunknown/,
      '01145' => %r/userunknown/,
      '01146' => %r/userunknown/,
      '01147' => %r/mesgtoobig/,
      '01148' => %r/userunknown/,
      '01149' => %r/userunknown/,
      '01150' => %r/userunknown/,
      '01151' => %r/mailboxfull/,
      '01152' => %r/systemerror/,
      '01153' => %r/mailererror/,
      '01154' => %r/userunknown/,
      '01155' => %r/mesgtoobig/,
      '01156' => %r/userunknown/,
      '01157' => %r/(?:hostunknown|filtered)/,
      '01158' => %r/expired/,
      '01159' => %r/mailboxfull/,
      '01160' => %r/filtered/,
      '01161' => %r/userunknown/,
      '01162' => %r/(?:userunknown|filtered)/,
      '01163' => %r/userunknown/,
      '01164' => %r/rejected/,
      '01165' => %r/exceedlimit/,
      '01166' => %r/contenterror/,
      '01167' => %r/norelaying/,
      '01168' => %r/blocked/,
      '01169' => %r/policyviolation/,
      '01170' => %r/blocked/,
      '01171' => %r/expired/,
      '01172' => %r/systemerror/,
      '01173' => %r/userunknown/,
      '01174' => %r/hostunknown/,
      '01175' => %r/blocked/,
      '01176' => %r/hasmoved/,
      '01177' => %r/mailererror/,
      '01178' => %r/hostunknown/,
      '01179' => %r/userunknown/,
      '01180' => %r/userunknown/,
      '01181' => %r/mesgtoobig/,
      '01182' => %r/userunknown/,
      '01183' => %r/suspend/,
      '01184' => %r/filtered/,
      '01185' => %r/expired/,
      '01186' => %r/securityerror/,
      '01187' => %r/securityerror/,
      '01188' => %r/userunknown/,
      '01189' => %r/expired/,
      '01190' => %r/securityerror/, # spamdetected
      '01191' => %r/suspend/,
      '01192' => %r/userunknown/,
      '01193' => %r/userunknown/,
      '01194' => %r/suspend/,
      '01195' => %r/securityerror/,
      '01196' => %r/suspend/,
      '01197' => %r/userunknown/,
      '01198' => %r/userunknown/,
      '01199' => %r/blocked/,
      '01200' => %r/hostunknown/,
      '01201' => %r/spamdetected/,
      '01202' => %r/systemfull/,
      '01203' => %r/securityerror/, # spamdetected
      '01204' => %r/suspend/,
      '01205' => %r/userunknown/,
      '01206' => %r/systemerror/,
      '01207' => %r/userunknown/,
      '01208' => %r/expired/,
    },
    'SurfControl' => {
      '01001' => %r/filtered/,
      '01002' => %r/filtered/,
      '01003' => %r/filtered/,
      '01004' => %r/systemerror/,
      '01005' => %r/systemerror/,
    },
    'V5sendmail' => {
      '01001' => %r/userunknown/,
      '01002' => %r/(?:userunknown|hostunknown)/,
      '01003' => %r/hostunknown/,
      '01004' => %r/hostunknown/,
      '01005' => %r/(?:userunknown|hostunknown)/,
      '01006' => %r/hostunknown/,
      '01007' => %r/(?:userunknown|hostunknown)/,
      '01008' => %r/hostunknown/,
      '01009' => %r/(?:hostunknown|userunknown)/,
      '01010' => %r/hostunknown/,
      '01011' => %r/hostunknown/,
      '01012' => %r/userunknown/,
      '01013' => %r/userunknown/,
      '01014' => %r/hostunknown/,
      '01015' => %r/hostunknown/,
      '01016' => %r/hostunknown/,
      '01017' => %r/userunknown/,
      '01018' => %r/(?:userunknown|hostunknown)/,
      '01019' => %r/filtered/,
      '01020' => %r/userunknown/,
      '01021' => %r/hostunknown/,
      '01022' => %r/(?:userunknown|hostunknown)/,
      '01023' => %r/hostunknown/,
      '01024' => %r/hostunknown/,
      '01025' => %r/hostunknown/,
      '01026' => %r/(?:hostunknown|userunknown)/,
      '01027' => %r/hostunknown/,
      '01028' => %r/(?:hostunknown|userunknown)/,
      '01029' => %r/(?:userunknown|hostunknown)/,
      '01030' => %r/hostunknown/,
      '01031' => %r/hostunknown/,
      '01032' => %r/userunknown/,
      '01033' => %r/(?:userunknown|hostunknown)/,
      '01034' => %r/hostunknown/,
      '01035' => %r/hostunknown/,
      '01036' => %r/userunknown/,
      '01037' => %r/hostunknown/,
      '01038' => %r/userunknown/,
      '01039' => %r/hostunknown/,
      '01040' => %r/hostunknown/,
      '01041' => %r/(?:userunknown|hostunknown)/,
      '01042' => %r/hostunknown/,
      '01043' => %r/(?:hostunknown|userunknown)/,
      '01044' => %r/hostunknown/,
      '01045' => %r/(?:hostunknown|userunknown)/,
      '01046' => %r/hostunknown/,
      '01047' => %r/hostunknown/,
      '01048' => %r/hostunknown/,
      '01049' => %r/userunknown/,
      '01050' => %r/(?:hostunknown|onhold)/,
      '01051' => %r/(?:hostunknown|userunknown)/,
      '01052' => %r/(?:blocked|hostunknown|userunknown)/,
      '01053' => %r/userunknown/,
      '01054' => %r/(?:hostunknown|userunknown)/,
      '01055' => %r/(?:hostunknown|userunknown)/,
      '01056' => %r/(?:userunknown|hostunknown)/,
      '01057' => %r/hostunknown/,
      '01058' => %r/userunknown/,
      '01059' => %r/hostunknown/,
      '01060' => %r/(?:hostunknown|userunknown)/,
      '01061' => %r/userunknown/,
      '01062' => %r/(?:hostunknown|userunknown)/,
      '01063' => %r/hostunknown/,
      '01064' => %r/(?:hostunknown|userunknown)/,
      '01065' => %r/hostunknown/,
      '01066' => %r/(?:userunknown|norelaying)/,
      '01067' => %r/hostunknown/,
      '01068' => %r/hostunknown/,
      '01069' => %r/filtered/,
      '01070' => %r/hostunknown/,
      '01071' => %r/hostunknown/,
      '01072' => %r/(?:hostunknown|userunknown)/,
      '01073' => %r/(?:hostunknown|userunknown)/,
      '01074' => %r/(?:systemerror|userunknown)/,
      '01075' => %r/hostunknown/,
      '01076' => %r/(?:hostunknown|userunknown)/,
      '01077' => %r/hostunknown/,
      '01078' => %r/hostunknown/,
      '01079' => %r/hostunknown/,
      '01080' => %r/hostunknown/,
      '01081' => %r/(?:hostunknown|userunknown)/,
      '01082' => %r/userunknown/,
      '01083' => %r/hostunknown/,
      '01084' => %r/hostunknown/,
      '01085' => %r/hostunknown/,
      '01086' => %r/hostunknown/,
      '01087' => %r/(?:userunknown|hostunknown)/,
      '01088' => %r/hostunknown/,
      '01089' => %r/hostunknown/,
      '01090' => %r/(?:hostunknown|userunknown)/,
      '01091' => %r/hostunknown/,
      '01092' => %r/hostunknown/,
      '01093' => %r/hostunknown/,
      '01094' => %r/(?:userunknown|hostunknown)/,
      '01095' => %r/(?:userunknown|hostunknown)/,
      '01096' => %r/(?:userunknown|hostunknown)/,
      '01097' => %r/(?:userunknown|hostunknown)/,
      '01098' => %r/userunknown/,
      '01099' => %r/(?:hostunknown|userunknown|blocked)/,
      '01100' => %r/userunknown/,
      '01101' => %r/hostunknown/,
      '01102' => %r/hostunknown/,
      '01103' => %r/hostunknown/,
      '01104' => %r/userunknown/,
      '01105' => %r/hostunknown/,
      '01106' => %r/userunknown/,
      '01107' => %r/userunknown/,
      '01108' => %r/hostunknown/,
      '01109' => %r/hostunknown/,
      '01110' => %r/hostunknown/,
      '01111' => %r/userunknown/,
      '01112' => %r/userunknown/,
      '01113' => %r/blocked/,
      '01114' => %r/hostunknown/,
      '01115' => %r/networkerror/,
      '01116' => %r/hostunknown/,
      '01117' => %r/blocked/,
      '01118' => %r/(?:hostunknown|userunknown)/,
      '01119' => %r/expired/,
      '01120' => %r/(?:userunknown|hostunknown)/,
      '01121' => %r/hostunknown/,
      '01122' => %r/blocked/,
      '01123' => %r/hostunknown/,
      '01124' => %r/expired/,
      '01125' => %r/expired/,
      '01126' => %r/(?:userunknown|hostunknown)/,
      '01127' => %r/expired/,
      '01128' => %r/norelaying/,
      '01129' => %r/hostunknown/,
      '01130' => %r/expired/,
      '01131' => %r/(?:userunknown|hostunknown)/,
      '01132' => %r/filtered/,
      '01133' => %r/hostunknown/,
      '01134' => %r/expired/,
      '01135' => %r/hostunknown/,
      '01136' => %r/hostunknown/,
      '01137' => %r/(?:userunknown|hostunknown)/,
      '01138' => %r/userunknown/,
      '01139' => %r/(?:userunknown|hostunknown)/,
      '01140' => %r/(?:hostunknown|userunknown)/,
      '01141' => %r/hostunknown/,
      '01142' => %r/(?:systemerror|userunknown)/,
      '01143' => %r/hostunknown/,
      '01144' => %r/(?:hostunknown|userunknown)/,
    },
    'X1' => {
      '01001' => %r/filtered/,
      '01002' => %r/filtered/,
      '01003' => %r/filtered/,
      '01004' => %r/filtered/,
      '01005' => %r/filtered/,
    },
    'X2' => {
      '01001' => %r/norelaying/,
      '01002' => %r/filtered/,
      '01003' => %r/filtered/,
      '01004' => %r/(?:suspend|filtered)/,
      '01005' => %r/expired/,
      '01006' => %r/hostunknown/,
      '01007' => %r/expired/,
      '01008' => %r/expired/,
      '01009' => %r/mailboxfull/,
      '01010' => %r/suspend/,
      '01011' => %r/mailboxfull/,
      '01012' => %r/suspend/,
      '01013' => %r/suspend/,
      '01014' => %r/suspend/,
      '01015' => %r/suspend/,
      '01016' => %r/suspend/,
      '01017' => %r/(?:suspend|filtered)/,
      '01018' => %r/suspend/,
      '01019' => %r/mailboxfull/,
      '01020' => %r/filtered/,
      '01021' => %r/(?:filtered|suspend)/,
      '01022' => %r/filtered/,
      '01023' => %r/suspend/,
      '01024' => %r/suspend/,
      '01025' => %r/suspend/,
      '01026' => %r/suspend/,
      '01027' => %r/mailboxfull/,
      '01028' => %r/expired/,
    },
    'X3' => {
      '01001' => %r/userunknown/,
      '01002' => %r/undefined/,
      '01003' => %r/expired/,
      '01004' => %r/userunknown/,
      '01005' => %r/undefined/,
      '01006' => %r/userunknown/,
      '01007' => %r/expired/,
      '01008' => %r/userunknown/,
    },
    'X4' => {
      '01001' => %r/mailboxfull/,
      '01002' => %r/mailboxfull/,
      '01003' => %r/hostunknown/,
      '01004' => %r/mailboxfull/,
      '01005' => %r/userunknown/,
      '01006' => %r/userunknown/,
      '01007' => %r/userunknown/,
      '01008' => %r/userunknown/,
      '01009' => %r/userunknown/,
      '01010' => %r/hostunknown/,
      '01011' => %r/userunknown/,
      '01012' => %r/mailboxfull/,
      '01013' => %r/mailboxfull/,
      '01014' => %r/mailboxfull/,
      '01015' => %r/mailboxfull/,
      '01016' => %r/mailboxfull/,
      '01017' => %r/networkerror/,
      '01018' => %r/userunknown/,
      '01019' => %r/userunknown/,
      '01020' => %r/mailboxfull/,
      '01021' => %r/networkerror/,
      '01022' => %r/userunknown/,
    },
    'X5' => {
      '01001' => %r/userunknown/,
      '01002' => %r/userunknown/,
    },
  }

  PrivateMTAChildren.each_key do |x|
    d0 = './set-of-emails/private/mta-' + x.downcase
    next unless Dir.exist?(d0)

    describe x do
      example 'directory exists' do
        expect(Dir.exist?(d0)).to be true
      end

      dhandle = Dir.open(d0)
      while e = dhandle.read do
        next if e == '.'
        next if e == '..'

        emailfn = sprintf('%s/%s', d0, e)
        sisimai = Sisimai.make(emailfn, delivered: true)
        n = e.sub(/\A(\d+)[-].*[.]eml/, '\1')

        example sprintf('[%s] %s has valid regular expression', n, x) do
          expect(PrivateMTAChildren[x][n]).to be_a Regexp
        end

        example sprintf('[%s] %s have 1 or more element', n, x) do
          expect(sisimai).to be_a Array
          expect(sisimai.size).to be > 0
        end
        next unless sisimai

        sisimai.each do |ee|
          it 'is Sisimai::Data object' do
            expect(ee).to be_a Sisimai::Data
          end

          example sprintf('[%s] %s#token = %s', n, x, ee.token) do
            expect(ee.token).to be_a String
            expect(ee.token.size).to be > 0
          end
          example sprintf('[%s] %s#lhost = %s', n, x, ee.lhost) do
            expect(ee.lhost).to be_a String
            expect(ee.lhost).not_to match(/[ ]/)
          end
          example sprintf('[%s] %s#rhost = %s', n, x, ee.rhost) do
            expect(ee.rhost).to be_a String
            expect(ee.rhost).not_to match(/[ ]/)
          end
          example sprintf('[%s] %s#alias = %s', n, x, ee.alias) do
            expect(ee.alias).to be_a String
            expect(ee.alias).not_to match(/[ ]/)
          end
          example sprintf('[%s] %s#listid = %s', n, x, ee.listid) do
            expect(ee.listid).to be_a String
            expect(ee.listid).not_to match(/[ ]/)
          end
          example sprintf('[%s] %s#action = %s', n, x, ee.action) do
            expect(ee.action).to be_a String
            expect(ee.action).not_to match(/[ ]/)
            if ee.action.size > 0
              expect(ee.action).to match(/(?:fail.+|delayed|expired|expanded)\z/)
            end
          end
          example sprintf('[%s] %s#messageid = %s', n, x, ee.messageid) do
            expect(ee.messageid).to be_a String
            expect(ee.messageid).not_to match(/[ ]/)
          end
          example sprintf('[%s] %s#smtpcommand = %s', n, x, ee.smtpcommand) do
            expect(ee.smtpcommand).to be_a String
            expect(ee.smtpcommand).not_to match(/[ ]/)
          end
          example sprintf('[%s] %s#diagnosticcode = %s', n, x, ee.diagnosticcode) do
            expect(ee.diagnosticcode).to be_a String
          end
          example sprintf('[%s] %s#replycode = %s', n, x, ee.replycode) do
            expect(ee.replycode).to be_a String
            expect(ee.replycode).to match(/\A(?:[45]\d\d|)\z/)
          end

          example sprintf('[%s] %s#feedbacktype = %s', n, x, ee.feedbacktype) do
            expect(ee.feedbacktype).to be_a String
          end
          example sprintf('[%s] %s#subject = %s', n, x, ee.subject) do
            expect(ee.subject).to be_a String
          end

          example sprintf('[%s] %s#deliverystatus = %s', n, x, ee.deliverystatus) do
            expect(ee.deliverystatus).to be_a String
            expect(ee.deliverystatus.size).to be > 0
            expect(ee.deliverystatus).to match(/\A[245][.]\d/)
            expect(ee.deliverystatus).not_to match(/[ ]/)
          end

          example sprintf('[%s] %s#softbounce = %s', n, x, ee.softbounce) do
            expect(ee.softbounce).to be_a Integer
            expect(ee.softbounce.between?(-1,1)).to be true
            if ee.reason =~ /(?:feedback|vacation|delivered)/
              expect(ee.softbounce).to be == -1
            elsif ee.reason =~ /(?:unknown|hasmoved)/
              expect(ee.softbounce).to be == 0
            else
              expect(ee.softbounce.to_s).to match(/[01]/)
            end
          end

          example sprintf('[%s] %s#smtpagent = %s', n, x, ee.smtpagent) do
            expect(ee.smtpagent).to be_a String
            expect(ee.smtpagent.size).to be > 0
            if x == 'MFILTER'
              expect(ee.smtpagent).to be == 'MTA::mFILTER'
            elsif x == 'X4'
              expect(ee.smtpagent).to match(/\AMTA::(?:qmail|X4)\z/)
            elsif x == 'Qmail'
              expect(ee.smtpagent).to be == 'MTA::qmail'
            else
              expect(ee.smtpagent).to be == 'MTA::' + x
            end
          end

          reason0 = PrivateMTAChildren[x][n]
          example sprintf('[%s] %s#reason = %s', n, x, ee.reason) do
            expect(ee.reason).to be_a String
            expect(ee.reason.size).to be > 0
            expect(ee.reason).to match(reason0)
          end

          example sprintf('[%s] %s#timezoneoffset = %s', n, x, ee.timezoneoffset) do
            expect(ee.timezoneoffset).to be_a String
            expect(ee.timezoneoffset).to match(/\A[+-]\d+\z/)
          end

          example sprintf('[%s] %s#timestamp = %s', n, x, ee.timestamp) do
            expect(ee.timestamp).to be_a Sisimai::Time
            expect(ee.timestamp.year.between?(1982,2100)).to be true
            expect(ee.timestamp.month.between?(1,12)).to be true
            expect(ee.timestamp.day.between?(1,31)).to be true
            expect(ee.timestamp.wday.between?(0,6)).to be true
          end

          example sprintf('[%s] %s#addresser = %s', n, x, ee.addresser) do
            expect(ee.addresser).to be_a Sisimai::Address
            expect(ee.addresser.host).to be_a String
            unless Sisimai::RFC5322.is_mailerdaemon(ee.addresser.address)
              expect(ee.addresser.host.size).to be > 0 
            end
            expect(ee.addresser.host).not_to match(/[ ]/)
            expect(ee.addresser.host).to be == ee.senderdomain

            expect(ee.addresser.user).to be_a String
            expect(ee.addresser.user.size).to be > 0
            expect(ee.addresser.user).not_to match(/[ ]/)

            expect(ee.addresser.address).to be_a String
            expect(ee.addresser.address.size).to be > 0
            expect(ee.addresser.address).not_to match(/[ ]/)

            expect(ee.addresser.verp).to be_a String
            expect(ee.addresser.verp).not_to match(/[ ]/)

            expect(ee.addresser.alias).to be_a String
            expect(ee.addresser.alias).not_to match(/[ ]/)
          end

          example sprintf('[%s] %s#recipient = %s', n, x, ee.recipient) do
            expect(ee.recipient).to be_a Sisimai::Address
            expect(ee.recipient.host).to be_a String
            unless Sisimai::RFC5322.is_mailerdaemon(ee.recipient.address)
              expect(ee.recipient.host.size).to be > 0
            end
            expect(ee.recipient.host).not_to match(/[ ]/)
            expect(ee.recipient.host).to be == ee.destination

            expect(ee.recipient.user).to be_a String
            expect(ee.recipient.user.size).to be > 0
            expect(ee.recipient.user).not_to match(/[ ]/)

            expect(ee.recipient.address).to be_a String
            expect(ee.recipient.address.size).to be > 0
            expect(ee.recipient.address).not_to match(/[ ]/)

            expect(ee.recipient.verp).to be_a String
            expect(ee.recipient.verp).not_to match(/[ ]/)

            expect(ee.recipient.alias).to be_a String
            expect(ee.recipient.alias).not_to match(/[ ]/)
          end

        end

      end

    end
  end
end

